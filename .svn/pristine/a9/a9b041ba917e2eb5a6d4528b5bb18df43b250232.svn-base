// (C)2010- メイプルストーリーマクロ生活 http://maplez2.blog90.fc2.com/
// 一部・全部に関わらず、転載・転売等は一切お断りします。
// 違反された場合、他の購入者の権利をを守るためにも、
// 刑事告訴等の法的措置を取らざるを得ません。
// その場合、民事提訴にて損害賠償の請求をさせて頂きます。

ACW(GETID("MapleStory","MapleStoryClass"),1,1)

WHILE TRUE

//▼▼アイテム欄が埋まるか、箱が0になるまで箱開け▼▼
WHILE TRUE
FOR X = 1 TO 40
KBD(VK_NEXT,0,10)
NEXT
IF CHKIMG("../画像/ピラミッド箱開け1.BMP",0,0,0,100,800) THEN BREAK
IF CHKIMG("../画像/ピラミッド箱開け3.BMP",0,0,0,1030,800) THEN BREAK
WEND

//▼▼アイテム欄が開いていたら閉じる▼▼
//アイテム欄を右端に配置していれば閉じる必要なし
IF CHKIMG("../画像/アイテム欄.BMP",0,0,0,1030,800) THEN KBD(VK_I,0,500)

IF CHKIMG("../画像/MP60%.BMP",0,0,0,600,800) THEN KBD(VK_DELETE,0,300)

KBD(VK_Y,0,500)
BTN(LEFT,0,475,270,500) // 店の消費タブをクリック

FOR Y = 1 TO 3　//消費欄を拡張してある場合は、3の数値を少し増やしてください
FOR X = 1 TO 8
SLEEP(0.3)

IFB CHKIMG("../画像/青い丸薬.BMP",0,0,0,600,600)
FOR X = 1 TO 3
BTN(LEFT,0,G_IMG_X,G_IMG_Y,100)
NEXT
KBD(VK_ENTER,0,300)
MMV(600,380,300)
SLEEP(0.3)
ENDIF

IFB CHKIMG("../画像/白い丸薬.BMP",0,0,0,600,600)
FOR X = 1 TO 3
BTN(LEFT,0,G_IMG_X,G_IMG_Y,100)
NEXT
KBD(VK_ENTER,0,300)
MMV(600,380,300)
SLEEP(0.3)
ENDIF

IFB CHKIMG("../画像/ウナギ焼.BMP",0,0,0,600,600)
FOR X = 1 TO 3
BTN(LEFT,0,G_IMG_X,G_IMG_Y,100)
NEXT
KBD(VK_ENTER,0,300)
MMV(600,380,300)
SLEEP(0.3)
ENDIF

IFB CHKIMG("../画像/マナエリクサー.BMP",0,0,0,600,600)
FOR X = 1 TO 3
BTN(LEFT,0,G_IMG_X,G_IMG_Y,100)
NEXT
KBD(VK_ENTER,0,300)
MMV(600,380,300)
SLEEP(0.3)
ENDIF

IFB CHKIMG("../画像/エリクサー.BMP",0,0,0,600,600)
FOR X = 1 TO 3
BTN(LEFT,0,G_IMG_X,G_IMG_Y,100)
NEXT
KBD(VK_ENTER,0,300)
MMV(600,380,300)
SLEEP(0.3)
ENDIF

IFB CHKIMG("../画像/パワーエリクサー.BMP",0,0,0,600,600)
FOR X = 1 TO 3
BTN(LEFT,0,G_IMG_X,G_IMG_Y,100)
NEXT
KBD(VK_ENTER,0,300)
MMV(600,380,300)
SLEEP(0.3)
ENDIF

NEXT

IF CHKIMG("../画像/ピラミッド箱開け2.BMP",0,0,0,800,600) THEN BREAK
BTN(WHEEL,-5,600,380,500)

NEXT

BTN(LEFT,0,360,195,500) // 商店から出るをクリック
IF CHKIMG("../画像/ピラミッド箱開け3.BMP",0,0,0,1030,800) THEN BREAK

WEND

//▼▼終わったら音でお知らせ▼▼
SOUND("BEEP")