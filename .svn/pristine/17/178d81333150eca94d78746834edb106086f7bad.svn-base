// (C)2010- メイプルストーリーマクロ生活 http://maplez2.blog90.fc2.com/
// 一部・全部に関わらず、転載・転売等は一切お断りします。
// 違反された場合、他の購入者の権利をを守るためにも、
// 刑事告訴等の法的措置を取らざるを得ません。
// その場合、民事提訴にて損害賠償の請求をさせて頂きます。

THREAD 並列処理() //一番↓で指定した処理を、メイン部分と並列で実行

//▼▼自動狩りメイン部分ココから▼▼
ACW(GETID("MapleStory","MapleStoryClass"),1,1)

//▼▼ペットのエサの設定１▼▼
PET = GETTIME( 900 / 86400 )
//▲▲ココまで▲▲

WHILE TRUE

FOR A = 1 TO 1 // 最後の★に対応

//薬の残量を確認、HP薬が9個以下、MP薬が0個だった場合はログアウト
IF CHKIMG("../画像/十字旅団最上級体力水薬9.bmp",0,0,0,800,580) THEN CALL ../共通/ログアウト.UWS
IF CHKIMG("../画像/十字旅団最上級魔力水薬0.bmp",0,0,0,800,580) THEN CALL ../共通/ログアウト.UWS

//滞在マップ確認・この画像を発見したら異常が起きたと判断してログアウト
IF CHKIMG("../画像/エルナス.BMP",0,0,0,250,200) THEN CALL ../共通/ログアウト.UWS

//▼▼一番下のハシゴで補助スキル1回目▼▼
KBD(VK_G,0,200)
KBD(VK_V,0,3000)
SLEEP(1)

//▼▼下から2段目に移動▼▼
KBD(VK_UP,1)
KBD(VK_RIGHT,1)
WHILE CHKIMG("../画像/黄点.BMP",0,0,0,50,220)
WEND
KBD(VK_RIGHT,2)
KBD(VK_UP,2)

//▼▼下から2段目殲滅▼▼
FOR Z = 1 TO 2　// ←2往復に設定してあります
	KBD(VK_RIGHT,1)
	WHILE CHKIMG("../画像/黄点.BMP",0,0,0,80,220)
		FOR X = 1 TO 3
		KBD(VK_HOME,0,100)
		NEXT
		FOR X = 1 TO 3
		KBD(VK_CTRL,0,100)
		NEXT
		SLEEP(0.2)
		IF CHKIMG("../画像/エルナス.BMP",0,0,0,250,200) THEN CALL ../共通/ログアウト.UWS
	WEND
		FOR X = 1 TO 3
		KBD(VK_HOME,0,100)
		NEXT
		FOR X = 1 TO 3
		KBD(VK_CTRL,0,100)
		NEXT
		SLEEP(0.2)
	KBD(VK_RIGHT,2)
	KBD(VK_LEFT,1)	
	WHILE !CHKIMG("../画像/黄点.BMP",0,0,0,60,220)
		FOR X = 1 TO 3
		KBD(VK_HOME,0,100)
		NEXT
		FOR X = 1 TO 3
		KBD(VK_CTRL,0,100)
		NEXT
		SLEEP(0.2)
		IF CHKIMG("../画像/エルナス.BMP",0,0,0,250,200) THEN CALL ../共通/ログアウト.UWS
	WEND
		FOR X = 1 TO 3
		KBD(VK_HOME,0,100)
		NEXT
		FOR X = 1 TO 3
		KBD(VK_CTRL,0,100)
		NEXT
		SLEEP(0.2)
	KBD(VK_LEFT,2)
NEXT

//▼▼下から3段目へ移動▼▼
KBD(VK_LEFT,1)
WHILE !CHKIMG("../画像/黄点.BMP",0,0,0,38,210)
IF CHKIMG("../画像/エルナス.BMP",0,0,0,250,200) THEN CALL ../共通/ログアウト.UWS
WEND
KBD(VK_LEFT,2)

KBD(VK_RIGHT,1)
KBD(VK_UP,1)
WHILE CHKIMG("../画像/黄点.BMP",0,0,0,43,200)
WEND
KBD(VK_RIGHT,2)
KBD(VK_UP,2)

IF !CHKIMG("../画像/黄点.BMP",0,0,0,110,180) THEN BREAK // 登れていなかった場合は★まで飛んで場所をリセット

//▼▼下から3段目殲滅▼▼
FOR X = 1 TO 20
KBD(VK_CTRL,0,100)
NEXT

KBD(VK_RIGHT,1)
WHILE CHKIMG("../画像/黄点.BMP",0,0,0,50,210)
KBD(VK_HOME,0,100)
WEND
KBD(VK_RIGHT,2)

FOR X = 1 TO 20
KBD(VK_CTRL,0,100)
NEXT

//▼▼上から２段目に移動▼▼
KBD(VK_LEFT,1)
WHILE !CHKIMG("../画像/黄点.BMP",0,0,0,50,210)
IF CHKIMG("../画像/エルナス.BMP",0,0,0,250,200) THEN CALL ../共通/ログアウト.UWS
WEND
KBD(VK_LEFT,2)

KBD(VK_RIGHT,1)
KBD(VK_UP,1)
WHILE CHKIMG("../画像/黄点.BMP",0,0,0,53,175)
WEND
KBD(VK_UP,2)
KBD(VK_RIGHT,2)

IF !CHKIMG("../画像/黄点.BMP",0,0,0,110,155) THEN BREAK // 登れていなかった場合は★まで飛んで場所をリセット

//▼▼上から２段目殲滅▼▼
FOR Z = 1 TO 2　// ←2往復に設定してあります
	KBD(VK_RIGHT,1)
	WHILE CHKIMG("../画像/黄点.BMP",0,0,0,80,300)
		FOR X = 1 TO 3
		KBD(VK_HOME,0,100)
		NEXT
		FOR X = 1 TO 3
		KBD(VK_CTRL,0,100)
		NEXT
		SLEEP(0.2)
		IF CHKIMG("../画像/エルナス.BMP",0,0,0,250,200) THEN CALL ../共通/ログアウト.UWS
	WEND
		FOR X = 1 TO 3
		KBD(VK_HOME,0,100)
		NEXT
		FOR X = 1 TO 3
		KBD(VK_CTRL,0,100)
		NEXT
		SLEEP(0.2)
	KBD(VK_RIGHT,2)
	KBD(VK_LEFT,1)	
	WHILE !CHKIMG("../画像/黄点.BMP",0,0,0,60,300)
		FOR X = 1 TO 3
		KBD(VK_HOME,0,100)
		NEXT
		FOR X = 1 TO 3
		KBD(VK_CTRL,0,100)
		NEXT
		SLEEP(0.2)
		IF CHKIMG("../画像/エルナス.BMP",0,0,0,250,200) THEN CALL ../共通/ログアウト.UWS
	WEND
		FOR X = 1 TO 3
		KBD(VK_HOME,0,100)
		NEXT
		FOR X = 1 TO 3
		KBD(VK_CTRL,0,100)
		NEXT
		SLEEP(0.2)
	KBD(VK_LEFT,2)
NEXT
	KBD(VK_RIGHT,1)
		FOR X = 1 TO 3
		KBD(VK_HOME,0,100)
		NEXT
		FOR X = 1 TO 3
		KBD(VK_CTRL,0,100)
		NEXT
		SLEEP(0.2)
	KBD(VK_RIGHT,2)

//▼▼上段へのロープへ移動▼▼
KBD(VK_RIGHT,1)
KBD(VK_UP,1)
WHILE !CHKIMG("../画像/黄点.BMP",0,0,0,65,135)
IF !CHKIMG("../画像/黄点.BMP",0,0,0,70,210) THEN BREAK 2 // 登れていなかった場合は★まで飛んで場所をリセット
IF CHKIMG("../画像/エルナス.BMP",0,0,0,250,200) THEN CALL ../共通/ログアウト.UWS
WEND
KBD(VK_UP,2)
KBD(VK_RIGHT,2)

//▼▼このロープで補助スキル2回目▼▼
KBD(VK_G,0,200)
KBD(VK_V,0,3000)
SLEEP(1)

//▼▼上段へ移動▼▼
KBD(VK_RIGHT,1)
KBD(VK_UP,1)
WHILE CHKIMG("../画像/黄点.BMP",0,0,0,65,150)
WEND
KBD(VK_UP,2)
KBD(VK_RIGHT,2)

//▼▼上段殲滅▼▼
FOR Z = 1 TO 2　// ←2往復に設定してあります
	KBD(VK_RIGHT,1)
	WHILE CHKIMG("../画像/黄点.BMP",0,0,0,80,300)
		FOR X = 1 TO 3
		KBD(VK_HOME,0,100)
		NEXT
		FOR X = 1 TO 3
		KBD(VK_CTRL,0,100)
		NEXT
		SLEEP(0.2)
		IF CHKIMG("../画像/エルナス.BMP",0,0,0,250,200) THEN CALL ../共通/ログアウト.UWS
	WEND
		FOR X = 1 TO 3
		KBD(VK_HOME,0,100)
		NEXT
		FOR X = 1 TO 3
		KBD(VK_CTRL,0,100)
		NEXT
		SLEEP(0.2)
	KBD(VK_RIGHT,2)
	KBD(VK_LEFT,1)	
	WHILE !CHKIMG("../画像/黄点.BMP",0,0,0,60,300)
		FOR X = 1 TO 3
		KBD(VK_HOME,0,100)
		NEXT
		FOR X = 1 TO 3
		KBD(VK_CTRL,0,100)
		NEXT
		SLEEP(0.2)
		IF CHKIMG("../画像/エルナス.BMP",0,0,0,250,200) THEN CALL ../共通/ログアウト.UWS
	WEND
		FOR X = 1 TO 3
		KBD(VK_HOME,0,100)
		NEXT
		FOR X = 1 TO 3
		KBD(VK_CTRL,0,100)
		NEXT
		SLEEP(0.2)
	KBD(VK_LEFT,2)
NEXT

NEXT // ★　段差から落ちてしまった場合などは、ココまで飛んで場所をリセット
KBD(VK_UP,2)
KBD(VK_RIGHT,2)
KBD(VK_LEFT,2)

//▼▼左端までジャンプ連打で移動▼▼
KBD(VK_LEFT,1)
WHILE !CHKIMG("../画像/黄点.BMP",0,0,0,40,210)
KBD(VK_HOME,0,100)
KBD(VK_C,0,100)
IF CHKIMG("../画像/エルナス.BMP",0,0,0,250,200) THEN CALL ../共通/ログアウト.UWS
WEND

//▼▼一番下まで移動▼▼
KBD(VK_DOWN,1,500)
WHILE CHKIMG("../画像/黄点.BMP",0,0,0,100,190)
KBD(VK_C,0,200)
WEND
KBD(VK_DOWN,2)
KBD(VK_C,0,300)
KBD(VK_LEFT,2,200)

//▼▼下段殲滅▼▼
//最初にテレポだけで１往復
KBD(VK_RIGHT,1)
WHILE CHKIMG("../画像/黄点.BMP",0,0,0,90,300)
KBD(VK_HOME,0,100)
WEND
KBD(VK_RIGHT,2)
KBD(VK_LEFT,1)	
WHILE !CHKIMG("../画像/黄点.BMP",0,0,0,42,300)
KBD(VK_HOME,0,100)
IF CHKIMG("../画像/エルナス.BMP",0,0,0,250,200) THEN CALL ../共通/ログアウト.UWS
WEND
KBD(VK_LEFT,2)

SLEEP(0.2)
FOR X = 1 TO 3
KBD(VK_CTRL,0,100)
NEXT
SLEEP(0.2)

FOR Z = 1 TO 2 // ←2往復に設定してあります
	KBD(VK_RIGHT,1)
	WHILE CHKIMG("../画像/黄点.BMP",0,0,0,80,300)
		FOR X = 1 TO 3
		KBD(VK_HOME,0,100)
		NEXT
		FOR X = 1 TO 3
		KBD(VK_CTRL,0,100)
		NEXT
		SLEEP(0.2)
		IF CHKIMG("../画像/エルナス.BMP",0,0,0,250,200) THEN CALL ../共通/ログアウト.UWS
	WEND
		FOR X = 1 TO 3
		KBD(VK_HOME,0,100)
		NEXT
		FOR X = 1 TO 3
		KBD(VK_CTRL,0,100)
		NEXT
		SLEEP(0.2)
	KBD(VK_RIGHT,2)
	KBD(VK_LEFT,1)	
	WHILE !CHKIMG("../画像/黄点.BMP",0,0,0,60,300)
		FOR X = 1 TO 3
		KBD(VK_HOME,0,100)
		NEXT
		FOR X = 1 TO 3
		KBD(VK_CTRL,0,100)
		NEXT
		SLEEP(0.2)
		IF CHKIMG("../画像/エルナス.BMP",0,0,0,250,200) THEN CALL ../共通/ログアウト.UWS
	WEND
		FOR X = 1 TO 3
		KBD(VK_HOME,0,100)
		NEXT
		FOR X = 1 TO 3
		KBD(VK_CTRL,0,100)
		NEXT
		SLEEP(0.2)
	KBD(VK_LEFT,2)
NEXT

//▼▼下段から2段目へのハシゴに移動▼▼
KBD(VK_LEFT,1)
WHILE !CHKIMG("../画像/黄点.BMP",0,0,0,45,220)
IF CHKIMG("../画像/エルナス.BMP",0,0,0,250,200) THEN CALL ../共通/ログアウト.UWS
WEND
KBD(VK_LEFT,2)

KBD(VK_RIGHT,1)
KBD(VK_UP,1)
WHILE !CHKIMG("../画像/黄点.BMP",0,0,0,60,190)
IF !CHKIMG("../画像/黄点.BMP",0,0,0,60,210) THEN BREAK
IF CHKIMG("../画像/エルナス.BMP",0,0,0,250,200) THEN CALL ../共通/ログアウト.UWS
WEND
KBD(VK_UP,2)
KBD(VK_RIGHT,2)

//▼▼ペットのエサの設定２▼▼
IFB GETTIME() > PET
KBD(VK_T,0,100)// ←Tを押す命令　必要なら変更してください
SLEEP(0.1)
PET = GETTIME( 900 / 86400 )
ENDIF
//▲▲ココまで▲▲

WEND
//▲▲自動狩りメイン部分ココまで▲▲


PROCEDURE 並列処理()
WHILE TRUE
//▼▼自動狩りメイン部分と並列して繰り返し行う処理ココから▼▼



//▲▲ココまで▲▲
WEND
FEND


