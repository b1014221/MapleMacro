// (C)2010- メイプルストーリーマクロ生活 http://maplez2.blog90.fc2.com/
// 一部・全部に関わらず、転載・転売等は一切お断りします。
// 違反された場合、他の購入者の権利をを守るためにも、
// 刑事告訴等の法的措置を取らざるを得ません。
// その場合、民事提訴にて損害賠償の請求をさせて頂きます。

THREAD 並列処理() //一番↓で指定した処理を、メイン部分と並列で実行

//▼▼ゴミ捨て時にクリックする位置の指定▼▼
ゴミ捨てX = 550 // 左から550
ゴミ捨てY = 100  // 上から100の位置をクリック

//▼▼メイン部分ココから▼▼
ACW(GETID("MapleStory","MapleStoryClass"),1,1)

//▼▼ペットのエサの設定１▼▼
PET = GETTIME( 900 / 86400 )
//▲▲ココまで▲▲

//▼▼砂城の遊び場にいない場合（画像認識に失敗した場合）はスタートしません▼▼
WHILE !CHKIMG("../画像/砂城の遊び場.BMP",0,0,0,200,200)
WEND

WHILE TRUE

G = 10

//▼▼狩り部分ココから▼▼
WHILE TRUE

//薬の残量を確認、HP薬が9個以下、MP薬が0個だった場合はログアウト
IF CHKIMG("../画像/十字旅団最上級体力水薬9.bmp",0,0,0,800,580) THEN CALL ../共通/ログアウト.UWS
IF CHKIMG("../画像/十字旅団最上級魔力水薬0.bmp",0,0,0,800,580) THEN CALL ../共通/ログアウト.UWS

//▼▼他のプレイヤーがいた場合・ココから▼▼
WHILE CHKIMG("../画像/赤点.BMP",0,0,0,200,200)
SLEEP(15) //とりあえず15秒待機
IF !CHKIMG("../画像/赤点.BMP",0,0,0,200,200) THEN BREAK // いなくなっていたら狩り再開
//↑15秒待ってもいなくならない場合は↓チャンネル変更
FOR X = 1 TO 50
KBD(VK_C,0,100)
NEXT
KBD(VK_ESC,0,100)
KBD(VK_ENTER,0,500)
KBD(VK_RIGHT,0,500)
KBD(VK_ENTER,0,500)
SLEEP(5)
WEND
//▲▲他のプレイヤーがいた場合・ココまで▲▲

//▼▼補助スキル▼▼
IFB G > 1 // マップ2周ごとに補助スキル
	FOR X = 1 TO 5
	KBD(VK_G,0,100)
	NEXT
	SLEEP(1) // スキル使用後の待機時間
	G = 0
ENDIF

//▼▼下段▼▼
KBD(VK_RIGHT,1)
KBD(VK_CTRL,0,100)
WHILE CHKIMG("../画像/黄点.BMP",0,0,0,160,200)
KBD(VK_CTRL,0,1000) // 1秒おきに攻撃、必要なら調整を
IF CHKIMG("../画像/クエスト完了.BMP",1,0,0,800,600) THEN BREAK 2
WEND
KBD(VK_RIGHT,2,1000)

//滞在マップ確認・この画像を発見したら異常が起きたと判断してログアウト
IF CHKIMG("../画像/アクアリウム.BMP",0,0,0,200,200) THEN CALL ../共通/ログアウト.UWS

//▼▼2段目右▼▼
WHILE !CHKIMG("../画像/黄点.BMP",0,0,0,180,145)
KBD(VK_C,0,100)
WEND
FOR X = 1 TO 3
KBD(VK_C,0,100)
NEXT
KBD(VK_LEFT,1)
KBD(VK_DOWN,1)
KBD(VK_DOWN,2,500)
KBD(VK_CTRL,0)
WHILE !CHKIMG("../画像/黄点.BMP",0,0,0,135,200)
KBD(VK_CTRL,0,1000) // 1秒おきに攻撃、必要なら調整を
IF CHKIMG("../画像/クエスト完了.BMP",1,0,0,800,600) THEN BREAK 2
WEND
KBD(VK_LEFT,2)

//滞在マップ確認・この画像を発見したら異常が起きたと判断してログアウト
IF CHKIMG("../画像/アクアリウム.BMP",0,0,0,200,200) THEN CALL ../共通/ログアウト.UWS

//▼▼3段目右▼▼
KBD(VK_LEFT,1)
FOR X = 1 TO 3
KBD(VK_C,0,400)
NEXT
WHILE !CHKIMG("../画像/黄点.BMP",0,0,0,98,200)
WEND
KBD(VK_CTRL,0)
KBD(VK_LEFT,2)
KBD(VK_RIGHT,1)
KBD(VK_CTRL,0,100)
WHILE CHKIMG("../画像/黄点.BMP",0,0,0,150,200)
KBD(VK_CTRL,0,1000) // 1秒おきに攻撃、必要なら調整を
IF CHKIMG("../画像/クエスト完了.BMP",1,0,0,800,600) THEN BREAK 2
WEND
KBD(VK_RIGHT,2)

//滞在マップ確認・この画像を発見したら異常が起きたと判断してログアウト
IF CHKIMG("../画像/アクアリウム.BMP",0,0,0,200,200) THEN CALL ../共通/ログアウト.UWS

//▼▼上段▼▼
KBD(VK_LEFT,1,500)
KBD(VK_C,0)
WHILE !CHKIMG("../画像/黄点.BMP",0,0,0,140,200)
KBD(VK_C,0,200)
WEND
KBD(VK_LEFT,2)
KBD(VK_DOWN,1)
KBD(VK_DOWN,2,500)
KBD(VK_LEFT,1)
KBD(VK_CTRL,0,100)
WHILE !CHKIMG("../画像/黄点.BMP",0,0,0,70,200)
KBD(VK_CTRL,0,1000) // 1秒おきに攻撃、必要なら調整を
IF CHKIMG("../画像/クエスト完了.BMP",1,0,0,800,600) THEN BREAK 2
WEND
KBD(VK_LEFT,2,500)

//滞在マップ確認・この画像を発見したら異常が起きたと判断してログアウト
IF CHKIMG("../画像/アクアリウム.BMP",0,0,0,200,200) THEN CALL ../共通/ログアウト.UWS

//▼▼3段目左▼▼
KBD(VK_LEFT,1)
WHILE !CHKIMG("../画像/黄点.BMP",0,0,0,32,200)
WEND
KBD(VK_LEFT,2)
KBD(VK_CTRL,0,100)
KBD(VK_RIGHT,1)
WHILE CHKIMG("../画像/黄点.BMP",0,0,0,70,200)
KBD(VK_CTRL,0,1000) // 1秒おきに攻撃、必要なら調整を
IF CHKIMG("../画像/クエスト完了.BMP",1,0,0,800,600) THEN BREAK 2
WEND
KBD(VK_RIGHT,2,500)

//滞在マップ確認・この画像を発見したら異常が起きたと判断してログアウト
IF CHKIMG("../画像/アクアリウム.BMP",0,0,0,200,200) THEN CALL ../共通/ログアウト.UWS

//▼▼2段目左▼▼
KBD(VK_RIGHT,1)
WHILE CHKIMG("../画像/黄点.BMP",0,0,0,95,200)
WEND
KBD(VK_DOWN,1)
KBD(VK_DOWN,2,200)
KBD(VK_RIGHT,2)
KBD(VK_LEFT,1)
KBD(VK_CTRL,0,100)
WHILE !CHKIMG("../画像/黄点.BMP",0,0,0,45,200)
KBD(VK_CTRL,0,1000) // 1秒おきに攻撃、必要なら調整を
IF CHKIMG("../画像/クエスト完了.BMP",1,0,0,800,600) THEN BREAK 2
WEND
KBD(VK_LEFT,2,500)

//滞在マップ確認・この画像を発見したら異常が起きたと判断してログアウト
IF CHKIMG("../画像/アクアリウム.BMP",0,0,0,200,200) THEN CALL ../共通/ログアウト.UWS

//▼▼左下地点へ▼▼
KBD(VK_LEFT,1)
WHILE !CHKIMG("../画像/黄点.BMP",0,0,0,20,200)
WEND
KBD(VK_LEFT,2)
KBD(VK_DOWN,1)
KBD(VK_DOWN,2,500)

G = G + 1

//▼▼ペットのエサの設定２▼▼
IFB GETTIME() > PET
KBD(VK_T,0,500)// ←Tを押す命令　必要なら変更してください
SLEEP(0.1)
PET = GETTIME( 900 / 86400 )
ENDIF
//▲▲ココまで▲▲

WEND
//▲▲狩り部分ココまで▲▲
KBD(VK_RIGHT,2)
KBD(VK_LEFT,2)

WHILE TRUE
	//▼▼アイテムウィンドウが開いてなかったら開く▼▼
	IFB !CHKIMG("../画像/アイテム欄.BMP",0,0,0,800,580)
	KBD(VK_I,0,500)
	ENDIF

	//▼▼消費欄クリック▼▼
	SLEEP(1)
	CHKIMG("../画像/アイテム欄.BMP",0,0,0,800,580)
	BTN(LEFT,0,G_IMG_X+35,G_IMG_Y-235,500)

	//▼▼帰還の書でアクアリウムへ移動▼▼
	WHILE TRUE
	IF CHKIMG("../画像/帰還の書.BMP",0,0,0,800,580) THEN BREAK
	WEND
	FOR X = 1 TO 6
	BTN(LEFT,0,G_IMG_X,G_IMG_Y,100)
	NEXT
	FOR X = 1 TO 10
	IF CHKIMG("../画像/アクアリウム.BMP",0,0,0,200,200) THEN BREAK 2
	SLEEP(1)
	NEXT
WEND

//▼▼ライディングを使用する場合はココ 1/2 ▼▼

//▲▲ライディングを使用する場合はココ▲▲

//▼▼アクアリウム→センターホール▼▼
IFB CHKIMG("../画像/黄点.BMP",0,0,0,50,200)
	KBD(VK_RIGHT,1)
	WHILE CHKIMG("../画像/黄点.BMP",0,0,0,80,200)
	//▼▼テレポを使用する場合はココ 1/4 ▼▼

	//▲▲テレポを使用する場合はココ▲▲
	WEND
	KBD(VK_RIGHT,2)
ELSEIF !CHKIMG("../画像/黄点.BMP",0,0,0,110,200)	
	KBD(VK_LEFT,1)
	WHILE !CHKIMG("../画像/黄点.BMP",0,0,0,100,200)
	//▼▼テレポを使用する場合はココ 2/4 ▼▼

	//▲▲テレポを使用する場合はココ▲▲
	WEND
	KBD(VK_LEFT,2)
ENDIF

WHILE TRUE
	IFB !CHKIMG("../画像/黄点.BMP",0,0,0,96,200)
	KBD(VK_LEFT,1)
	WHILE !CHKIMG("../画像/黄点.BMP",0,0,0,96,200)//位置がズレる場合は96を増減
	KBD(VK_UP,0)
	IF !CHKIMG("../画像/アクアリウム.BMP",0,0,0,200,200) THEN BREAK 2		
	WEND
	KBD(VK_LEFT,2)
	ENDIF
	KBD(VK_RIGHT,1)
	WHILE CHKIMG("../画像/黄点.BMP",0,0,0,96,200)//位置がズレる場合は96を増減
	KBD(VK_UP,0)
	IF !CHKIMG("../画像/アクアリウム.BMP",0,0,0,200,200) THEN BREAK 2
	WEND
	KBD(VK_RIGHT,2)
WEND
KBD(VK_RIGHT,2)
KBD(VK_LEFT,2)

WHILE !CHKIMG("../画像/センターホール.BMP",0,0,0,200,200)
WEND

//▼▼消費欄ゴミ捨て▼▼
WHILE TRUE
IF CHKIMG("../画像/アイテム欄.BMP",0,0,0,800,600) THEN BREAK
WEND
BTN(LEFT,CLICK,G_IMG_X+35,G_IMG_Y-240,500)//消費欄クリック
SLEEP(0.5)
//「木の手裏剣」があったら捨てる
FOR X = 1 TO 5
	IFB CHKIMG("../画像/木の手裏剣.BMP",0,0,0,800,300)
	BTN(LEFT,0,G_IMG_X,G_IMG_Y,500)//アイテムクリック
	BTN(LEFT,0,ゴミ捨てX,ゴミ捨てY,500)//捨てる
	KBD(VK_ENTER,0,500)
	BTN(LEFT,0,ゴミ捨てX,ゴミ捨てY,500)
	ENDIF
NEXT
//「木のこま」があったら捨てる
FOR X = 1 TO 5
	IFB CHKIMG("../画像/木のこま.BMP",0,0,0,800,300)
	BTN(LEFT,0,G_IMG_X,G_IMG_Y,500)//アイテムクリック
	BTN(LEFT,0,ゴミ捨てX,ゴミ捨てY,500)//捨てる
	KBD(VK_ENTER,0,500)
	BTN(LEFT,0,ゴミ捨てX,ゴミ捨てY,500)
	ENDIF
NEXT

//▼▼ETC欄ゴミ捨て▼▼
WHILE TRUE
IF CHKIMG("../画像/アイテム欄.BMP",0,0,0,800,600) THEN BREAK
WEND
BTN(LEFT,CLICK,G_IMG_X+70,G_IMG_Y-240,500)//ETC欄クリック
SLEEP(0.5)
//「フラワーフィッシュの花びら」があったら捨てる
FOR X = 1 TO 5
	IFB CHKIMG("../画像/フラワーフィッシュの花びら.BMP",0,0,0,800,300)
	BTN(LEFT,0,G_IMG_X,G_IMG_Y,500)//アイテムクリック
	BTN(LEFT,0,ゴミ捨てX,ゴミ捨てY,500)//捨てる
	KBD(VK_ENTER,0,500)
	BTN(LEFT,0,ゴミ捨てX,ゴミ捨てY,500)
	ENDIF
NEXT
//「シュリンプの肉」があったら捨てる
FOR X = 1 TO 5
	IFB CHKIMG("../画像/シュリンプの肉.BMP",0,0,0,800,300)
	BTN(LEFT,0,G_IMG_X,G_IMG_Y,500)//アイテムクリック
	BTN(LEFT,0,ゴミ捨てX,ゴミ捨てY,500)//捨てる
	KBD(VK_ENTER,0,500)
	BTN(LEFT,0,ゴミ捨てX,ゴミ捨てY,500)
	ENDIF
NEXT
//「SOS救助要請手紙」があったら捨てる
FOR X = 1 TO 3
	IFB CHKIMG("../画像/SOS救助要請手紙.BMP",0,0,0,800,300)
	BTN(LEFT,0,G_IMG_X,G_IMG_Y,500)//アイテムクリック
	BTN(LEFT,0,ゴミ捨てX,ゴミ捨てY,500)//捨てる
	KBD(VK_ENTER,0,500)
	BTN(LEFT,0,ゴミ捨てX,ゴミ捨てY,500)
	ENDIF
NEXT
//「魔法の石」があったら捨てる
IFB CHKIMG("../画像/魔法の石.BMP",0,0,0,800,300)
BTN(LEFT,0,G_IMG_X,G_IMG_Y,500)//アイテムクリック
BTN(LEFT,0,ゴミ捨てX,ゴミ捨てY,500)//捨てる
KBD(VK_ENTER,0,500)
BTN(LEFT,0,ゴミ捨てX,ゴミ捨てY,500)
ENDIF

//▼▼アイテムウィンドウを閉じる▼▼
KBD(VK_I,0,500)
KBD(VK_ESC,0,500)
BTN(LEFT,0,50,50,500)

//▼▼イベントガイドの所へ移動▼▼
KBD(VK_RIGHT,1)
WHILE CHKIMG("../画像/黄点.BMP",0,0,0,83,200)
WEND
KBD(VK_RIGHT,2)

//▼▼クエスト完了→再受注▼▼
MMV(50,50,500)//マウスカーソルが邪魔にならないように移動
WHILE !CHKIMG("../画像/シアワセノカケラNPC.BMP",0,0,0,800,620)
KBD(VK_Y,0)
SLEEP(1.5)
WEND
KBD(VK_ESC,0)

//▼▼センターホール→アクアリウム▼▼
KBD(VK_LEFT,1)
WHILE !CHKIMG("../画像/黄点.BMP",0,0,0,75,200)
//▼▼テレポを使用する場合はココ 3/4 ▼▼

//▲▲テレポを使用する場合はココ▲▲
WEND
KBD(VK_LEFT,2)

WHILE TRUE
	KBD(VK_LEFT,1)
	WHILE !CHKIMG("../画像/黄点.BMP",0,0,0,63,200)//位置がズレる場合は63を増減
	KBD(VK_UP,0)
	IF !CHKIMG("../画像/センターホール.BMP",0,0,0,200,200) THEN BREAK 2		
	WEND
	KBD(VK_LEFT,2)
	KBD(VK_RIGHT,1)
	WHILE CHKIMG("../画像/黄点.BMP",0,0,0,63,200)//位置がズレる場合は63を増減
	KBD(VK_UP,0)
	IF !CHKIMG("../画像/センターホール.BMP",0,0,0,200,200) THEN BREAK 2
	WEND
	KBD(VK_RIGHT,2)
WEND
KBD(VK_RIGHT,2)
KBD(VK_LEFT,2)

WHILE !CHKIMG("../画像/アクアリウム.BMP",0,0,0,200,200)
WEND

//▼▼アクアリウム→東側の分かれ道▼▼
KBD(VK_RIGHT,1)
WHILE CHKIMG("../画像/黄点.BMP",0,0,0,190,200)
//▼▼テレポを使用する場合はココ 4/4 ▼▼

//▲▲テレポを使用する場合はココ▲▲
WEND
KBD(VK_RIGHT,2)

WHILE TRUE
	KBD(VK_RIGHT,1)
	WHILE CHKIMG("../画像/黄点.BMP",0,0,0,201,200)//位置がズレる場合は201を増減
	KBD(VK_UP,0)
	IF !CHKIMG("../画像/アクアリウム.BMP",0,0,0,200,200) THEN BREAK 2
	WEND
	KBD(VK_RIGHT,2)
	KBD(VK_LEFT,1)
	WHILE !CHKIMG("../画像/黄点.BMP",0,0,0,201,200)//位置がズレる場合は201を増減
	KBD(VK_UP,0)
	IF !CHKIMG("../画像/アクアリウム.BMP",0,0,0,200,200) THEN BREAK 2		
	WEND
	KBD(VK_LEFT,2)
WEND
KBD(VK_RIGHT,2)
KBD(VK_LEFT,2)

WHILE !CHKIMG("../画像/東側の分かれ道.BMP",0,0,0,200,200)
WEND

//▼▼東側の分かれ道→海草の塔▼▼
KBD(VK_RIGHT,1)
WHILE CHKIMG("../画像/黄点.BMP",0,0,0,130,200)
KBD(VK_C,0,100)
WEND

WHILE TRUE
	KBD(VK_RIGHT,1)
	WHILE CHKIMG("../画像/黄点.BMP",0,0,0,161,200)//位置がズレる場合は161を増減
	KBD(VK_UP,0)
	IF !CHKIMG("../画像/東側の分かれ道.BMP",0,0,0,200,200) THEN BREAK 2
	WEND
	KBD(VK_RIGHT,2)
	KBD(VK_LEFT,1)
	WHILE !CHKIMG("../画像/黄点.BMP",0,0,0,161,200)//位置がズレる場合は161を増減
	KBD(VK_UP,0)
	IF !CHKIMG("../画像/東側の分かれ道.BMP",0,0,0,200,200) THEN BREAK 2		
	WEND
	KBD(VK_LEFT,2)
WEND
KBD(VK_RIGHT,2)
KBD(VK_LEFT,2)

WHILE !CHKIMG("../画像/海草の塔.BMP",0,0,0,250,250)
WEND

//▼▼海草の塔→砂城の遊び場▼▼
KBD(VK_RIGHT,1)
WHILE CHKIMG("../画像/黄点.BMP",0,0,0,45,250)
WEND
KBD(VK_RIGHT,2)

FOR X = 1 TO 3
KBD(VK_UP,1)
KBD(VK_UP,2,100)
SLEEP(0.5)
IF !CHKIMG("../画像/黄点.BMP",0,0,0,100,250) THEN BREAK
KBD(VK_RIGHT,1)
KBD(VK_RIGHT,2,50)
NEXT

KBD(VK_RIGHT,1)
WHILE CHKIMG("../画像/黄点.BMP",0,0,0,195,250)
WEND
KBD(VK_RIGHT,2)

KBD(VK_DOWN,1)
WHILE CHKIMG("../画像/黄点.BMP",0,0,0,210,200)
KBD(VK_C,0,100)
WEND
KBD(VK_DOWN,2)

WHILE TRUE
	KBD(VK_RIGHT,1)
	WHILE CHKIMG("../画像/黄点.BMP",0,0,0,203,250)//位置がズレる場合は203を増減
	KBD(VK_UP,0)
	IF !CHKIMG("../画像/海草の塔.BMP",0,0,0,250,250) THEN BREAK 2
	WEND
	KBD(VK_RIGHT,2)
	KBD(VK_LEFT,1)
	WHILE !CHKIMG("../画像/黄点.BMP",0,0,0,203,250)//位置がズレる場合は203を増減
	KBD(VK_UP,0)
	IF !CHKIMG("../画像/海草の塔.BMP",0,0,0,250,250) THEN BREAK 2		
	WEND
	KBD(VK_LEFT,2)
WEND
KBD(VK_RIGHT,2)
KBD(VK_LEFT,2)

WHILE !CHKIMG("../画像/砂城の遊び場.BMP",0,0,0,250,250)
WEND

//▼▼ライディングを使用する場合はココ 2/2 ▼▼

//▲▲ライディングを使用する場合はココ▲▲

WEND
//▲▲メイン部分ココまで▲▲


PROCEDURE 並列処理()
WHILE TRUE
//▼▼メイン部分と並列して繰り返し行う処理ココから▼▼



//▲▲ココまで▲▲
WEND
FEND
